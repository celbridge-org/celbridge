<ContentDialog
  x:Class="Celbridge.UserInterface.Views.NewProjectDialog"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="using:Celbridge.UserInterface.Views"
  xmlns:projects="using:Celbridge.Projects"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  PrimaryButtonText="{x:Bind CreateString}"
  SecondaryButtonText="{x:Bind CancelString}"
  IsPrimaryButtonEnabled="{x:Bind ViewModel.IsCreateButtonEnabled, Mode=OneWay}"
  PrimaryButtonClick="CreateButtonClick"
  SecondaryButtonClick="CancelButtonClick">

  <StackPanel Orientation="Vertical"
              HorizontalAlignment="Stretch"
              MinWidth="500"
              Spacing="12">

    <!-- Template Selection -->
    <TextBlock Text="{x:Bind ChooseTemplateString}"
               FontWeight="SemiBold"
               Margin="0,0,0,8"/>

    <GridView x:Name="TemplateGridView"
              ItemsSource="{x:Bind ViewModel.Templates}"
              SelectedItem="{x:Bind ViewModel.SelectedTemplate, Mode=TwoWay}"
              SelectionMode="Single"
              HorizontalAlignment="Left"
              Padding="8"
              ToolTipService.ToolTip="{x:Bind ChooseTemplateTooltipString}"
              ToolTipService.Placement="Bottom">
      <GridView.ItemTemplate>
      <DataTemplate x:DataType="projects:ProjectTemplate">
          <Grid Width="110" 
                Height="110" 
                Padding="8"
                CornerRadius="8"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
            <StackPanel VerticalAlignment="Center"
                        HorizontalAlignment="Center"
                        Spacing="4">
              <FontIcon Glyph="{x:Bind Icon}"
                        FontSize="36"
                        HorizontalAlignment="Center"
                        FontFamily="{ThemeResource SymbolThemeFontFamily}"/>
              <TextBlock Text="{x:Bind Name}"
                         TextAlignment="Center"
                         FontSize="12"
                         TextWrapping="Wrap"/>
            </StackPanel>
          </Grid>
        </DataTemplate>
      </GridView.ItemTemplate>
      <GridView.ItemsPanel>
        <ItemsPanelTemplate>
          <ItemsWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="4"/>
        </ItemsPanelTemplate>
      </GridView.ItemsPanel>
    </GridView>

    <!-- Template Description -->
    <TextBlock Text="{x:Bind ViewModel.SelectedTemplate.Description, Mode=OneWay}"
               TextWrapping="Wrap"
               Opacity="0.8"
               FontSize="12"
               Margin="0,0,0,8"/>

    <!-- Separator -->
    <Rectangle Height="1" 
               Fill="{ThemeResource DividerStrokeColorDefaultBrush}" 
               Margin="0,8,0,12"/>

    <!-- Project name text box -->
    <TextBox x:Name="ProjectNameTextBox"
             MinWidth="200"
             IsSpellCheckEnabled="False"
             PlaceholderText="{x:Bind ProjectNamePlaceholderString}"
             Header="{x:Bind ProjectNameString}"
             Text="{x:Bind ViewModel.ProjectName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
             ToolTipService.ToolTip="{x:Bind ProjectNameTooltipString}"
             ToolTipService.Placement="Bottom"
             Loaded="ProjectNameTextBox_Loaded"
             KeyDown="ProjectNameTextBox_KeyDown"/>

    <!-- Select folder grid -->
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="50"/>
      </Grid.ColumnDefinitions>

      <TextBox Grid.Column="0"
               PlaceholderText="{x:Bind ProjectFolderPlaceholderString}"
               Margin="0,0,8,0"
               IsSpellCheckEnabled="False"
               Header="{x:Bind ProjectFolderString}"
               Text="{x:Bind ViewModel.DestFolderPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
               ToolTipService.ToolTip="{x:Bind ProjectFolderTooltipString}"
               ToolTipService.Placement="Bottom"/>

      <Button Grid.Column="1"
              VerticalAlignment="Bottom"
              Margin="0,0,0,0"
              Command="{x:Bind ViewModel.SelectFolderCommand}"
              ToolTipService.ToolTip="{x:Bind BrowseFolderTooltipString}">
        <SymbolIcon Symbol="Folder"/>
      </Button>
    </Grid>

    <!-- Create subfolder checkbox -->
    <CheckBox HorizontalAlignment="Left"
              Content="{x:Bind CreateSubfolderString}"
              IsChecked="{x:Bind ViewModel.CreateSubfolder, Mode=TwoWay}"
              ToolTipService.ToolTip="{x:Bind CreateSubfolderTooltipString}"
              ToolTipService.Placement="Bottom"/>

    <!-- InfoBar container - both InfoBars occupy the same space -->
    <Grid MinHeight="80" Margin="0,12,0,0">
      <!-- Validation error message -->
      <InfoBar x:Name="ValidationErrorInfoBar"
               IsOpen="{x:Bind ViewModel.IsValidationErrorVisible, Mode=OneWay}"
               Severity="Error"
               IsClosable="False"
               IsIconVisible="True"
               Message="{x:Bind GetLocalizedErrorMessage(ViewModel.ValidationErrorMessage), Mode=OneWay}"/>

      <!-- Save location info -->
      <InfoBar x:Name="SaveLocationInfoBar"
               IsOpen="{x:Bind ViewModel.IsCreateButtonEnabled, Mode=OneWay}"
               Severity="Informational"
               IsClosable="False"
               IsIconVisible="True"
               Message="{x:Bind ViewModel.ProjectSaveLocation, Mode=OneWay}"/>
    </Grid>

  </StackPanel>

</ContentDialog>

