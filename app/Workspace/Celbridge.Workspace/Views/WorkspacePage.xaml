<uiviews:PersistentPage
    x:Class="Celbridge.Workspace.Views.WorkspacePage"
    x:Name="WorkspacePageName"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Celbridge.Workspace.Views"
    xmlns:uiviews="using:Celbridge.UserInterface.Views"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:vm="using:Celbridge.Workspace.ViewModels"
    NavigationCacheMode="Required"
    DataContext="{x:Bind ViewModel}">

  <Grid x:Name="LayoutRoot">
    
    <Grid.ColumnDefinitions>
      <ColumnDefinition x:Name="ContextPanelColumn" Width="Auto" MinWidth="100"/>
      <ColumnDefinition Width="*"/>
      <ColumnDefinition x:Name="InspectorPanelColumn" Width="Auto" MinWidth="100"/>
    </Grid.ColumnDefinitions>
    
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
      <RowDefinition x:Name="ToolsPanelRow" Height="Auto" MinHeight="100"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Explorer Panel -->
    <Grid x:Name="ContextPanel"
          Grid.RowSpan="3"
          MinWidth="100"
          Background="{ThemeResource PanelBackgroundABrush}"
          BorderBrush="{ThemeResource PanelBorderBrush}"
          BorderThickness="2,0,2,0"
          GotFocus="Panel_GotFocus"
          PointerPressed="Panel_PointerPressed">
    </Grid>

    <!-- Documents Panel -->
    <Grid x:Name="DocumentsPanel"
          Grid.Column="1"
          Background="{ThemeResource ApplicationBackgroundBrush}"
          GotFocus="Panel_GotFocus"
          PointerPressed="Panel_PointerPressed">

      <!-- Panel Visibility Toolbar -->
      <StackPanel x:Name="PanelVisibilityToolbar"
                  Orientation="Horizontal"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Top"
                  Margin="0,4,4,0">
        
        <!-- Explorer Panel Toggle (Left sidebar icon) -->
        <Button x:Name="ToggleExplorerPanelButton"
                Command="{x:Bind ViewModel.ToggleExplorerPanelCommand}"
                Margin="2,0"
                Padding="6">
          <Viewbox Width="16" Height="16">
            <Grid Width="16" Height="16">
              <!-- Outer frame -->
              <Rectangle Stroke="{ThemeResource SystemControlForegroundBaseHighBrush}" 
                         StrokeThickness="1.2" 
                         RadiusX="1" RadiusY="1"/>
              <!-- Left panel - filled when active -->
              <Rectangle x:Name="ExplorerPanelFill"
                         Width="5" Height="14" 
                         HorizontalAlignment="Left" 
                         VerticalAlignment="Center"
                         Margin="1,0,0,0"
                         Fill="{ThemeResource SystemControlForegroundBaseHighBrush}"/>
              <!-- Left panel divider - shown when collapsed -->
              <Line x:Name="ExplorerPanelDivider"
                    X1="6.5" Y1="2" X2="6.5" Y2="14"
                    Stroke="{ThemeResource SystemControlForegroundBaseHighBrush}"
                    StrokeThickness="1.2"
                    Visibility="Collapsed"/>
            </Grid>
          </Viewbox>
        </Button>
        
        <!-- Tools Panel Toggle (Bottom panel icon) -->
        <Button x:Name="ToggleToolsPanelButton"
                Command="{x:Bind ViewModel.ToggleToolsPanelCommand}"
                Margin="2,0"
                Padding="6">
          <Viewbox Width="16" Height="16">
            <Grid Width="16" Height="16">
              <!-- Outer frame -->
              <Rectangle Stroke="{ThemeResource SystemControlForegroundBaseHighBrush}" 
                         StrokeThickness="1.2" 
                         RadiusX="1" RadiusY="1"/>
              <!-- Bottom panel - filled when active -->
              <Rectangle x:Name="ToolsPanelFill"
                         Width="14" Height="5" 
                         HorizontalAlignment="Center" 
                         VerticalAlignment="Bottom"
                         Margin="0,0,0,1"
                         Fill="{ThemeResource SystemControlForegroundBaseHighBrush}"/>
              <!-- Bottom panel divider - shown when collapsed -->
              <Line x:Name="ToolsPanelDivider"
                    X1="2" Y1="9.5" X2="14" Y2="9.5"
                    Stroke="{ThemeResource SystemControlForegroundBaseHighBrush}"
                    StrokeThickness="1.2"
                    Visibility="Collapsed"/>
            </Grid>
          </Viewbox>
        </Button>
        
        <!-- Inspector Panel Toggle (Right sidebar icon) -->
        <Button x:Name="ToggleInspectorPanelButton"
                Command="{x:Bind ViewModel.ToggleInspectorPanelCommand}"
                Margin="2,0">
          <Viewbox Width="16" Height="16">
            <Grid Width="16" Height="16">
              <!-- Outer frame -->
              <Rectangle Stroke="{ThemeResource SystemControlForegroundBaseHighBrush}" 
                         StrokeThickness="1.2" 
                         RadiusX="1" RadiusY="1"/>
              <!-- Right panel - filled when active -->
              <Rectangle x:Name="InspectorPanelFill"
                         Width="5" Height="14" 
                         HorizontalAlignment="Right" 
                         VerticalAlignment="Center"
                         Margin="0,0,1,0"
                         Fill="{ThemeResource SystemControlForegroundBaseHighBrush}"/>
              <!-- Right panel divider - shown when collapsed -->
              <Line x:Name="InspectorPanelDivider"
                    X1="9.5" Y1="2" X2="9.5" Y2="14"
                    Stroke="{ThemeResource SystemControlForegroundBaseHighBrush}"
                    StrokeThickness="1.2"
                    Visibility="Collapsed"/>
            </Grid>
          </Viewbox>
        </Button>
        
        <!-- Focus Mode Toggle -->
        <Button x:Name="ToggleFocusModeButton"
                Command="{x:Bind ViewModel.ToggleFocusModeCommand}"
                Margin="2,0">
          <Button.KeyboardAccelerators>
            <KeyboardAccelerator Key="F4" />
          </Button.KeyboardAccelerators>
          <FontIcon x:Name="ToggleFocusModeIcon"
                    FontFamily="{ThemeResource SymbolThemeFontFamily}"
                    Glyph="&#xE92D;"
                    FontSize="16"/>
        </Button>
        
      </StackPanel>
    </Grid>

    <!-- Inspector Panel -->
    <Grid x:Name="InspectorPanel"
          Grid.Column="2"
          Grid.Row="0"
          Grid.RowSpan="3"
          MinWidth="100"
          Background="{ThemeResource PanelBackgroundABrush}"
          BorderBrush="{ThemeResource PanelBorderBrush}"
          BorderThickness="2,0,2,0"
          GotFocus="Panel_GotFocus"
          PointerPressed="Panel_PointerPressed">
    </Grid>

    <!-- Tools Panel -->
    <Grid x:Name="ToolsPanel"
          Grid.Column="1"
          Grid.Row="1"
          RowDefinitions="40, *"
          MinHeight="100"
          Background="{ThemeResource PanelBackgroundBBrush}"
          BorderBrush="{ThemeResource PanelBorderBrush}"
          BorderThickness="0,2,0,0"
          GotFocus="Panel_GotFocus"
          PointerPressed="Panel_PointerPressed">

      <Grid Grid.Row="0"
            Background="{ThemeResource PanelBackgroundABrush}"
            BorderBrush="{ThemeResource PanelBorderBrush}"
            BorderThickness="0,0,0,1">

        <TextBlock Text="{x:Bind ToolsPanelTitle}"
                   VerticalAlignment="Center"
                   Margin="6,0,0,0"/>
      </Grid>      
      <Grid x:Name="ToolsContent"
            Grid.Row="1"/>
    </Grid>

    <!-- Status Panel -->
    <Grid x:Name="StatusPanel"
          Grid.Column="1"
          Grid.Row="2"
          Background="{ThemeResource PanelBackgroundABrush}"
          BorderBrush="{ThemeResource PanelBorderBrush}"
          BorderThickness="0,1,0,0"
          GotFocus="Panel_GotFocus"
          PointerPressed="Panel_PointerPressed">
    </Grid>

    <!-- Grid splitters -->

    <controls:GridSplitter x:Name="ContextPanelSplitter"
                           Grid.Column="0"
                           Grid.RowSpan="3"
                           HorizontalAlignment="Right"
                           ResizeDirection="Auto"
                           ResizeBehavior="BasedOnAlignment"
                           Foreground="{ThemeResource PanelBackgroundBBrush}"/>

    <controls:GridSplitter x:Name="InspectorPanelSplitter"
                           Grid.Column="2"
                           Grid.RowSpan="3"
                           HorizontalAlignment="Left"
                           ResizeDirection="Auto"
                           ResizeBehavior="BasedOnAlignment"
                           Foreground="{ThemeResource PanelBackgroundBBrush}"/>

    <controls:GridSplitter x:Name="ToolsPanelSplitter"
                           Grid.Column="1"
                           Grid.Row="1"
                           Grid.RowSpan="1"
                           VerticalAlignment="Top"
                           Height="4"
                           Margin="0"
                           ResizeDirection="Auto"
                           ResizeBehavior="BasedOnAlignment"
                           Foreground="{ThemeResource PanelBackgroundBBrush}"/>
  </Grid>
</uiviews:PersistentPage>
